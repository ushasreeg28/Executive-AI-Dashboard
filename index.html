<!DOCTYPE html>
<html>
<head>
    <title>Executive AI Dashboard</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- <script type="module">
        // REPLACE WITH YOUR KEYS
        const ALPHA_VANTAGE_KEY = 'LE782VGY0ZU5KP4Z';
        // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
// const firebaseConfig = {
//   apiKey: "AIzaSyANPh4IDzimoezEQ-9JnvXEy_bQcZThu3Q",
//   authDomain: "realtime-executive-ai.firebaseapp.com",
//   databaseURL: "https://realtime-executive-ai-default-rtdb.firebaseio.com",
//   projectId: "realtime-executive-ai",
//   storageBucket: "realtime-executive-ai.firebasestorage.app",
//   messagingSenderId: "632372636045",
//   appId: "1:632372636045:web:f6d24ade5314da134435c4",
//   measurementId: "G-LV8P7HQDF8"
// };

// Initialize Firebase
// const app = initializeApp(firebaseConfig);
// const analytics = getAnalytics(app);
    const FIREBASE_CONFIG = {
            apiKey: "AIzaSyANPh4IDzimoezEQ-9JnvXEy_bQcZThu3Q",
            authDomain: "realtime-executive-ai.firebaseapp.com",
            databaseURL: "https://realtime-executive-ai-default-rtdb.firebaseio.com",
            projectId: "realtime-executive-ai",
            storageBucket: "realtime-executive-ai.firebasestorage.app",
            messagingSenderId: "632372636045",
            appId: "1:632372636045:web:f6d24ade5314da134435c4",
            measurementId: "G-LV8P7HQDF8"
        };
    </script> -->
</head>
<body>
    <h1>ðŸš€ Executive AI Dashboard</h1>
    <div id="stock-chart" style="width:800px;height:400px;border:1px solid #ccc;"></div>
    <div id="status">Loading live data...</div>
</body>

<!-- <script type="module">
        const ALPHA_VANTAGE_KEY = 'LE782VGY0ZU5KP4Z';
        // Import the functions you need from the SDKs you need
       // import { initializeApp } from "firebase/app";
        import { getAnalytics } from "firebase/analytics";

        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, onValue, set } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyANPh4IDzimoezEQ-9JnvXEy_bQcZThu3Q",
            authDomain: "realtime-executive-ai.firebaseapp.com",
            databaseURL: "https://realtime-executive-ai-default-rtdb.firebaseio.com",
            projectId: "realtime-executive-ai",
            storageBucket: "realtime-executive-ai.firebasestorage.app",
            messagingSenderId: "632372636045",
            appId: "1:632372636045:web:f6d24ade5314da134435c4",
            measurementId: "G-LV8P7HQDF8"
        };
    
    // Initialize Firebase
    const app = initializeApp(FIREBASE_CONFIG);
    const db = getDatabase(app);
    
    // Fetch live stock data every 30 seconds
    async function fetchStockData() {
        try {
            const response = await fetch(
                `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=IBM&interval=5min&apikey=${ALPHA_VANTAGE_KEY}`
            );
            const data = await response.json();
            
            // Extract latest price
            const timeSeries = data['Time Series (5min)'];
            const latestTime = Object.keys(timeSeries)[0];
            const latestPrice = parseFloat(timeSeries[latestTime]['4. close']);
            
            // Save to Firebase (live sync)
            await set(ref(db, 'stocks/IBM'), {
                price: latestPrice,
                time: new Date().toISOString(),
                change: '+1.2%'  // Calculate later
            });
            
            document.getElementById('status').textContent = `IBM: $${latestPrice} (Updated: ${new Date().toLocaleTimeString()})`;
        } catch (error) {
            document.getElementById('status').textContent = 'Error fetching data';
        }
    }
    
    // Listen for LIVE updates from Firebase
    const stockRef = ref(db, 'stocks/IBM');
    onValue(stockRef, (snapshot) => {
        const data = snapshot.val();
        if (data) {
            updateChart(data);
            document.getElementById('status').textContent = 
                `IBM: $${data.price} (${data.time})`;
        }
    });
    
</script> -->

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
    // Your config (paste yours here)
    const firebaseConfig = {
            apiKey: "AIzaSyANPh4IDzimoezEQ-9JnvXEy_bQcZThu3Q",
            authDomain: "realtime-executive-ai.firebaseapp.com",
            databaseURL: "https://realtime-executive-ai-default-rtdb.firebaseio.com",
            projectId: "realtime-executive-ai",
            storageBucket: "realtime-executive-ai.firebasestorage.app",
            messagingSenderId: "632372636045",
            appId: "1:632372636045:web:f6d24ade5314da134435c4",
            measurementId: "G-LV8P7HQDF8"
        };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    // Rest of your code stays same...
    const ALPHA_VANTAGE_KEY = 'LE782VGY0ZU5KP4Z'; // Remove real key for portfolio
    
    async function fetchStockData() {
        // Your existing fetchStockData function
        document.getElementById('status').textContent = 'Demo mode - Live D3.js working!';
    }
    
    // Listen for Firebase updates (compat syntax)
    db.ref('stocks/IBM').on('value', (snapshot) => {
        const data = snapshot.val();
        console.log("Firebase update:", data); // Debug log
        if (data) updateChart(data);
    });
 
    // D3.js Live Chart
    const svg = d3.select("#stock-chart")
        .append("svg")
        .attr("width", 800)
        .attr("height", 400);
    
    let prices = [];
    
    function updateChart(data) {
        prices.push({time: new Date(), price: data.price});
        console.log("Chart data:", prices);  // Open F12 â†’ Console to see

        if (prices.length > 20) prices.shift(); // Keep last 20 points
        
        // Clear and redraw
        svg.selectAll("*").remove();
        
        const xScale = d3.scaleLinear()
            .domain([0, prices.length - 1])
            .range([50, 750]);
            
        const yScale = d3.scaleLinear()
            .domain(d3.extent(prices, d => d.price))
            .range([350, 50]);
        
        // Draw line
        svg.append("path")
            .datum(prices)
            .attr("fill", "none")
            .attr("stroke", "steelblue")
            .attr("stroke-width", 2)
            .attr("d", d3.line()
                .x((d, i) => xScale(i))
                .y(d => yScale(d.price)));
    }
    
    // Start live updates
    fetchStockData();
    setInterval(fetchStockData, 30000); // Every 30 seconds


</script>

</html>
